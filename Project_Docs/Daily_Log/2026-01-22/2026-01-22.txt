===============================================================================
                    트렌드 키워드 수집 시스템 개발 보고서
===============================================================================

작성일시: 2026년 1월 22일 오후 3시
작성자: 개발팀
보고 대상: 프로젝트 매니저님

===============================================================================
1. 업무 개요
===============================================================================

목적:
    - 무료로 이용 가능한 실시간 트렌드 키워드 수집 시스템 구축
    - 국가별 맞춤형 트렌드 데이터 제공
    - 마케팅 활용 가능한 키워드 자동 추출 기능 구현

작업 기간: 2026년 1월 22일 오전 ~ 오후
주요 작업: 트렌드 소스 탐색, API 테스트, 시스템 구현

===============================================================================
2. 트렌드 소스 탐색 및 테스트 결과
===============================================================================

2.1 Google Trends (pytrends 라이브러리)
-------------------------------------------
시도 경위:
    - 전 세계 검색 트렌드를 국가별로 제공하는 가장 대표적인 소스
    - Python 라이브러리 pytrends 를 활용한 무료 접근 시도

테스트 과정:
    1. pytrends.trending_searches(pn='south_korea') 메서드 호출
    2. pytrends.realtime_trending_searches(pn='KR') 시도
    3. pytrends.today_searches(pn='KR') 시도
    4. 직접 RSS 피드 접근 시도
    5. Daily Trends API 엔드포인트 직접 호출 시도

테스트 결과:
    상태: 실패 (404 Not Found)
    
    에러 내용:
        - Google returned a response with code 404
        - 한국(KR), 미국(US) 모두 동일한 404 에러 발생
        - RSS 피드 URL도 404 응답
    
    원인 분석:
        - 구글이 무료 트렌드 API 엔드포인트를 폐쇄 또는 변경
        - 봇/스크립트 접근 차단 정책 강화
        - 브라우저 접근은 가능하나 프로그래밍 방식 접근 차단
    
    결론: 사용 불가 (서비스 차단됨)


2.2 Signal.bz (한국 실시간 검색어)
-------------------------------------------
시도 경위:
    - 네이버, 구글 등 한국 주요 포털의 실시간 검색어 통합 제공
    - 기존 프로젝트에서 사용하던 소스

테스트 과정:
    1. https://www.signal.bz/ 페이지 크롤링
    2. .rank-text CSS 셀렉터로 키워드 추출 시도

테스트 결과:
    상태: 불안정 (간헐적 실패)
    
    문제점:
        - 페이지 구조 변경으로 키워드 추출 실패
        - HTML 응답은 받지만 실제 키워드 데이터 없음
        - JavaScript 렌더링 필요 가능성
    
    결론: 백업용으로만 유지, 메인 소스로는 부적합


2.3 Nate (네이트 실시간 이슈)
-------------------------------------------
시도 경위:
    - 한국 포털 중 실시간 검색어 서비스 유지 중
    - Signal.bz의 대체 소스로 평가

테스트 과정:
    1. https://www.nate.com/ 메인 페이지 접근
    2. .isKeyword CSS 셀렉터로 키워드 추출
    3. 한국어 인코딩 처리 확인

테스트 결과:
    상태: 성공
    
    수집 데이터 예시:
        - 단식 장동혁
        - 이정후 LA
        - (실시간 인기 키워드 20개)
    
    장점:
        - 안정적인 HTML 구조
        - 한국 사용자 검색 패턴 반영
        - 실시간성 우수
        - 별도 API 키 불필요
    
    단점:
        - 한국(KR)만 지원
        - 크롤링 방식이라 구조 변경 시 수정 필요
    
    결론: 한국 트렌드 수집 메인 소스로 채택


2.4 Reddit Popular (글로벌 커뮤니티 트렌드)
-------------------------------------------
시도 경위:
    - Google Trends 대체 글로벌 소스 필요
    - Reddit JSON 엔드포인트 무료 제공

테스트 과정:
    1. https://www.reddit.com/r/popular/top.json?limit=25&t=day 호출
    2. JSON 파싱 및 제목 추출

테스트 결과:
    상태: 성공
    
    수집 데이터 형태:
        - People in Minnesota are now using...
        - (영문 이슈 제목 25개)
    
    장점:
        - 안정적인 JSON API
        - API 키 불필요
        - 전 세계 바이럴 이슈 반영
        - 영미권 중심의 실시간성
    
    단점:
        - 국가별 필터링 불가 (글로벌 통합)
        - 제목이 길어 순수 키워드보다는 토픽 성격
        - 비영어권 국가 트렌드는 부족
    
    결론: 글로벌(US 등) 트렌드 수집 메인 소스로 채택


2.5 Yahoo! Japan (일본 실시간 검색어)
-------------------------------------------
시도 경위:
    - 일본은 Google보다 Yahoo의 영향력이 큼
    - 일본 트렌드 전용 소스 필요

테스트 과정:
    1. https://search.yahoo.co.jp/realtime/search 접근
    2. 실시간 검색어 영역 셀렉터 파악
    3. YahooJapanClient 구현 (오늘 작업)

테스트 결과:
    상태: 구현 완료 (실제 동작 검증 예정)
    
    예상 장점:
        - 일본 사용자 실제 검색어 수집
        - Yahoo Japan 점유율 높음
    
    예상 단점:
        - 일본(JP)만 지원
        - 셀렉터 변경 가능성
    
    결론: 일본 트렌드 수집 전용 소스로 구현


2.6 Naver DataLab API (검토만 진행)
-------------------------------------------
검토 결과:
    - 네이버 클라우드 플랫폼 가입 필요
    - API 키 발급 및 일일 호출 제한(1000회)
    - 실시간 검색어가 아닌 통계 데이터
    
    결론: 무료이나 즉시 적용 어려움, 향후 검토 대상


===============================================================================
3. 최종 선택 솔루션 및 아키텍처
===============================================================================

3.1 국가별 트렌드 수집 전략
-------------------------------------------

한국 (KR):
    1순위: Nate 실시간 이슈
    2순위: Signal.bz (Fallback)
    3순위: Reddit (극단적 Fallback)

일본 (JP):
    1순위: Yahoo! Japan 실시간 검색어
    2순위: Reddit

미국 및 글로벌 (US, 기타):
    1순위: Reddit Popular
    
자동 모드 (Auto):
    - 국가별로 위 전략 자동 적용
    - Fallback 체인 구현


3.2 구현된 클라이언트 목록
-------------------------------------------

NateClient
    파일 위치: Back/clients/nate_client.py
    기능: 한국 네이트 실시간 이슈 크롤링
    메서드: get_realtime_trends() -> List[str]
    
RedditClient
    파일 위치: Back/clients/reddit_client.py
    기능: Reddit 글로벌 인기 토픽 수집
    메서드: get_global_trends() -> List[str]
    
YahooJapanClient
    파일 위치: Back/clients/yahoo_japan_client.py
    기능: 일본 야후 실시간 검색어 수집
    메서드: get_realtime_trends() -> List[str]
    
AIKeywordExtractor (신규 추가)
    파일 위치: Back/clients/ai_keyword_extractor.py
    기능: 수집된 콘텐츠에서 GenAI로 마케팅 키워드 추출
    메서드: extract_marketing_keywords(contents) -> List[str]
    사용 AI: OpenAI GPT-4o-mini


===============================================================================
4. 구현 완료 기능
===============================================================================

4.1 백엔드 API
-------------------------------------------

기존 수정 사항:
    - /trend/collect-trending
        변경: top_keywords 5개 -> 20개
        추가: ai_keywords 필드 (GenAI 추출 키워드)
        삭제: pytrends, signal 소스 옵션

신규 엔드포인트:
    - /trend/platform-keywords
        기능: 플랫폼별 실시간 검색어 전용 수집
        지원 국가: KR (Nate), JP (Yahoo Japan)
        응답: PlatformKeywordsResponse


4.2 프론트엔드 UI
-------------------------------------------

버튼 추가:
    - 기존: 콘텐츠 수집 버튼 (유지)
    - 신규: 플랫폼 검색어 추천 버튼
        조건부 표시: 한국, 일본 선택 시에만 활성화

키워드 배너 (3종):
    1. 급상승 키워드 Top 20 (녹색 계열)
        - 트렌드 수집 시 자동 표시
        - Nate/Reddit 기반 키워드
        
    2. 플랫폼 실시간 검색어 (파란색 계열)
        - 플랫폼 검색어 추천 버튼 클릭 시
        - Nate/Yahoo Japan 전용 검색어
        
    3. AI 마케팅 키워드 (보라색 계열)
        - 트렌드 수집 시 자동 생성
        - OpenAI GPT 분석 결과


===============================================================================
5. 기술적 개선 사항
===============================================================================

5.1 비동기 처리 최적화
-------------------------------------------
문제:
    - NateClient, RedditClient 메서드가 동기 함수였으나
      handle_exception 데코레이터가 비동기 래퍼 적용
      
해결:
    - 모든 Client 메서드를 async def로 변경
    - Service에서 await로 호출하도록 수정
    
영향:
    - TypeError: 'coroutine' object is not subscriptable 에러 해결
    - 비동기 처리 성능 향상


5.2 데이터베이스 상호작용
-------------------------------------------
기존 방식:
    - psycopg_pool 기반 Raw SQL
    
변경 사항:
    - SQLAlchemy Async Engine + asyncpg
    - Named Parameter (:param) 방식
    
이유:
    - 안정적인 커넥션 풀 관리
    - 고성능 asyncpg 드라이버
    - 유지보수 용이성


===============================================================================
6. 삭제된 기능 및 이유
===============================================================================

삭제 항목:
    - PytrendsClient (pytrends_client.py)
    - ScraperClient (scraper_client.py)
    
삭제 이유:
    1. Pytrends
        - Google의 API 엔드포인트 차단 (404)
        - 한국, 미국 모두 동작 불가
        - 우회 방법 없음 (Selenium 사용은 과도한 리소스)
        
    2. Signal.bz
        - 불안정한 동작
        - 키워드 추출 실패 빈번
        - Nate로 대체 가능
        
    3. UI 옵션
        - Pytrends 선택 옵션 제거
        - Signal.bz 선택 옵션 제거
        - 사용자 혼란 방지


===============================================================================
7. 향후 개선 과제
===============================================================================

단기 과제 (1-2주):
    1. Yahoo Japan 실제 동작 검증 및 셀렉터 최적화
    2. AI 키워드 추출 프롬프트 튜닝
    3. 플랫폼 검색어 캐싱 (동일 요청 반복 방지)

중기 과제 (1개월):
    1. 대만(TW) 트렌드 소스 발굴
    2. 인도네시아(ID) 트렌드 소스 발굴
    3. Naver DataLab API 연동 검토

장기 과제 (3개월):
    1. 트렌드 히스토리 분석 기능
    2. 키워드 상승/하락 추이 시각화
    3. 사용자 맞춤형 키워드 추천


===============================================================================
8. 참고 자료
===============================================================================

테스트 파일 (개발 중 생성, 정리 필요):
    - debug_pytrends.py
    - debug_realtime.py
    - check_reddit.py
    - check_rss.py
    - debug_signal.py
    
구현 파일:
    - Back/clients/nate_client.py
    - Back/clients/reddit_client.py
    - Back/clients/yahoo_japan_client.py
    - Back/clients/ai_keyword_extractor.py
    - Back/trend/service.py
    - Back/trend/router.py
    - Front/src/components/TrendCollector.jsx


===============================================================================
9. 결론
===============================================================================

성과:
    - 무료 트렌드 수집 시스템 안정화 완료
    - 국가별 맞춤형 소스 구축
    - GenAI 기반 마케팅 키워드 자동 추출 기능 구현
    - UI/UX 3단계 키워드 배너 제공

제약사항:
    - Google Trends 사용 불가 (외부 정책)
    - 비영어권 국가(대만, 인도네시아) 소스 부족

특이사항:
    - Pytrends 실패는 시스템 문제가 아닌 Google 정책 변경
    - 현 시점에서 무료로 접근 가능한 최선의 소스 구성 완료


===============================================================================
보고서 끝
===============================================================================
